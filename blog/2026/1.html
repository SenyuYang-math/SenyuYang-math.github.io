<html>
<head>  
<title id="pagetitle">Blog is loading...</title>
</head>

<body id="body">
<!--正文区块-->
<div id="container" class="container">
<p>
你好2026！这篇博客将介绍Lovász和Szegedy给出的分析版Szemerédi正则性引理，参见
</p>
<p style="font-size:small; font-color: grey">
L. Lovász & B. Szegedy, Szemerédi's lemma for the analysts, GAFA, Vol. 17(2007), 252 – 270.
</p>
<p>
我们首先引入所需的分析语言. 称二元函数 $W:[0,1]^{2} \to\mathbb{R}$ 为对称函数，如果对所有 $0 \leq x, y \leq 1$ 都有 $W(x, y) = W(y, x)$. 于是定义对称函数空间
$$\mathcal{W}:= \{ W:[0,1]^{2} \to\mathbb{R}:~ W~ \text{对称}, ~ |W| \lt \infty\}$$
和
$$\mathcal{W}_{0}:= \{W \in \mathcal{W}:~ W([0,1]^2) \subseteq [0,1]\}.$$ 
如果存在 $[0,1]$ 的划分 $\mathcal{P}:=\{S_{1}, ..., S_{m}\}$，s.t. $W\in \mathcal{W}$ 在每个 $S_{i} \times S_{j}$ 上为常数，则称函数 $U$ 为至多 $m$ 步的阶梯函数. 于是从分析的角度，我们可以自然地将图视为 $W_{0}$ 中的 $0$-$1$ 值阶梯函数，且其步长 $S_{i}$ 具有相等的测度。显然，每个这样的函数都对应一个以 $\{S_{i}\}$ 为顶点集的图，且每个图都可通过这种方式表示.  
</p>
<p>
值得一提的是，每个 $W \in \mathcal{W}$ 都可视为Hilbert空间 $L_{2}([0,1])$ 上的核算子，定义为 
$$W[f](x) := \int_{0}^{1} W(x, y) f(y) dy .$$  
除了标准的 $L_{2}$ 和 $L_{1}$ 范数外，我们还会在 $\mathcal{W}$ 上定义 
$$\| W \|_{\square} = \sup_{S, T \subseteq [0,1]} \left| \int_{S \times T} W(x, y) dx dy \right| ,$$ 
其中 $S,T$ 取遍 $[0,1]$ 中的可测集. 于是有对偶刻画
$$\begin{aligned} \| W \|_{\square} &= \sup_{f,g:[0,1] \to [0,1]} |\langle f, W g \rangle| \geq\sup_{f:[0,1] \to [0,1]} |\langle f, W f \rangle| \\ &\geq\sup_{S \subseteq [0,1]} \left| \int_{S \times S} W(x,y) dx dy \right| \geq\frac{1}{2} \| W \|_{\square} . \end{aligned}$$
其中最后一个不等号来自 $W$ 的对称性. 在下文我们会多次使用上述不等式.
</p>
<p>
  <b>注.</b> 在图极限理论中，这个 $\square$ 范数称为cut norm, $\mathcal{W}_0$ 中的元素称为graphon作为图的推广.
</p>
<p>
  在探讨上述概念与正则引理的关系前，我们先引入一个关键的分析工具.
</p>
<p class="thm">
<b>引理1</b> (Hilbert空间的正则引理)<b>.</b> 设 $K_{1}, K_{2}, \cdots$ 是Hilbert空间 $H$ 的任意非空子集。则对于任意 $\varepsilon > 0$ 和 $f \in H$，存在 $m \leq\lceil 1/\varepsilon^{2} \rceil$，以及 $f_{i} \in K_{i}$（$1 \leq i \leq m$）和 $\gamma_{1}, \gamma_{2}, \cdots, \gamma_{m} \in\mathbb{R}$，s.t 对于任意 $g \in K_{m+1}$ 都有 
$$\left| \left\langle g, f - \left( \gamma_{1} f_{1} + \cdots + \gamma_{m} f_{m} \right) \right\rangle\right| \leq\varepsilon\cdot\| g \|\cdot\| f \| .$$
</p>
<p>
  如果令集合 $K_{n}$ 是子空间，则 $\gamma_{1} f_{1} + \cdots + \gamma_{m} f_{m}$ 的一个自然选择是 $f$ 在子空间 $K_{1} + \cdots + K_{m}$ 中的最佳逼近（或近似最佳逼近，若最佳逼近不存在），此时误差 $f - (\gamma_{1} f_{1} + \cdots + \gamma_{m} f_{m})$ 与每个 $g \in K_{1} + \cdots + K_{m}$ 正交. 所以上述引理的核心在于误差与下一个集合 $K_{m+1}$ 也几乎正交.  
</p>
<p>
<i>证明.</i> 令 
$$\eta_{k} = \inf_{\{\gamma_{i}\}, \{f_{i}\}} \left\| f - \sum_{i=1}^{k} \gamma_{i} f_{i} \right\|^{2} ,$$ 
其中下确界取遍所有 $\gamma_{1}, ..., \gamma_{k} \in\mathbb{R}$ 和 $f_{i} \in K_{i}$. 显然有 $\|f\|^{2} \geq\eta_{1} \geq\eta_{2} \geq\cdots\geq 0$. 因此存在 $m \leq\lceil 1/\varepsilon^{2} \rceil$，s.t. $\eta_{m} \lt \eta_{m+1} + \varepsilon^{2} \|f\|^{2}$. 进一步地，存在 $\gamma_{1}, ..., \gamma_{m} \in\mathbb{R}$ 和 $f_{i} \in K_{i}$, s.t. 
$$\left\| f - \sum_{i=1}^{m} \gamma_{i} f_{i} \right\|^{2} \leq\eta_{m+1} + \varepsilon^{2} \|f\|^{2} .$$
令 $f^{*} = \sum_{i} \gamma_{i} f_{i}$, 考虑任意 $g \in K_{m+1}$. 由 $\eta_{m+1}$ 的定义，对于任意实数 $t$ 有 
$$\left\| f - \left( f^{*} + t g \right) \right\|^{2} \geq\eta_{m+1} \geq\left\| f - f^{*} \right\|^{2} - \varepsilon^{2} \|f\|^{2} ,$$
展开为 $t$ 的多项式
$$\| g \|^{2} t^{2} - 2 \left\langle g, f - f^{*} \right\rangle t + \varepsilon^{2} \|f\|^{2} \geq 0 .$$
判别式非正即证明了引理. $\quad$$\square$
</p>
<p>
  <b>注.</b> 证明的关键一步自然是 $\eta_m\lt \eta_{m+1}+O(\varepsilon^2)$, 我们可以看作 $\|f\|_{L^2}$ 有限抑制了所谓的“能量增量”(energy increment). 
</p>
<p>
  接下来我们给出该引理的一些推论.
</p>
<p class="thm">
<b>引理2</b> (弱正则引理，分析版)<b>.</b> 对于任意函数 $W \in \mathcal{W}_{0}$ 和 $\varepsilon > 0$, 存在一个至多 $\lceil 2^{2/\varepsilon^{2}} \rceil$ 步的阶梯函数 $W^* \in \mathcal{W}_{0}$，使得 $\|W - W^*\|_{\square} \leq\varepsilon$. 
</p>
<p>
考虑划分 $\mathcal{P}$ 和对应的一个阶梯函数 $W_{\mathcal{P}}$. 如果对于任意可测子集 $S \subseteq [0,1]$, 都有 $\| W - W_{\mathcal{P}} \|_\square \leq\varepsilon$, 我们就称 $\mathcal{P}$ 是 $W$ 的 $\varepsilon$-弱正则划分。因此引理2说明每个 $\mathcal{W}_0$ 函数都存在 $\varepsilon$-弱正则划分，且划分的子集数至多为 $2^{2/\varepsilon^{2}}$. 进一步地，我们可以将 $W_{\mathcal{P}}$ 调整为 $W$ 在 $\mathcal{P}$ 的每个子集上取平均值，这至多将误差放大为 $2\epsilon$. 于是从现在开始，我们就将弱正则逼近 $W_{\mathcal{P}}$ 等同于平均值修正的版本. 称为“弱”的原因留到后文解释.
</p>
<p>
<i>证明.</i> 考虑Hilbert空间 $H=L^{2}([0,1]^{2})$，并令每个 $K_{n}\subseteq \mathcal{W}_0$ 是全体对角乘积集 $S \times S$ 的示性函数集，其中 $S$ 取遍 $[0,1]$ 的可测子集. 设 $f \in \mathcal{W}_{0}$, 则引理1中构造的 $f^{*} = \sum_{i=1}^{k} \gamma_{i} f_{i}$ 是一个至多 $2^{k}$ 步的阶梯函数. 再根据对偶刻画，我们得到一个至多 $2^{\lceil 1/\varepsilon^{2} \rceil}$ 步的阶梯函数 $W^{*} \in \mathcal{W}_0$, s.t. 对于任意可测集 $S \subseteq [0,1]$, 都有 
$$\left| \int_{S \times S} \left( W - W^{*} \right) \right| \leq\varepsilon .$$
于是，对于任意两个可测集 $S, T \subseteq [0,1]$,
$$\left| \int_{S \times T} \left( W - W^{*} \right) \right| \leq 2\varepsilon.$$
引理2得证. $\quad$$\square$
</p>
<p>
<b>注.</b> 回忆正则引理的各种证明，都是基于非正则性 $\Rightarrow$ 能量增量这套思路. 读者可以尝试从另一方向证明弱正则引理：如果 $\|W-W_{\mathcal{P}}\|_{\square} \geq \varepsilon$, 则可以对 $\mathcal{P}$ 作一次细分 $\mathcal{P}'$, s.t. $\|W_{\mathcal{P}'}\|_{L^2}^2 \geq \|W_{\mathcal{P}}\| + \varepsilon^2$, 并控制划分数量的增长.
</p>
<p>
现在可以回到图论的场景了. 考虑一个图 $G=G(V,E)$, 对于 $V$ 的划分 $\mathcal{P} = \{V_{1}, ..., V_{k}\}$, 定义边密度 $d_{ij} := \frac{e_{G}(V_{i}, V_{j})}{|V_{i}| \cdot |V_{j}|}$, 其中 $e_G(S,T)$ 表示 $S,T\subset V$ 之间连接的边的数量. 对于任意两个子集 $S, T \subseteq V(G)$, 我们期望 $G$ 中连接 $S$ 和 $T$ 的边数约为 
$$e_{\mathcal{P}}(S, T) := \sum_{i=1}^{k} \sum_{j=1}^{k} d_{ij} \left| V_{i} \cap S \right| \cdot\left| V_{j} \cap T \right| .$$
因此，可通过 
$$\max_{S, T} \left| e_{G}(S, T) - e_{\mathcal{P}}(S, T) \right|$$
刻画划分的非正则性. 注意到，对比Szemerédi的非正则性指标 
$$\max_{i,j}\max_{S\subset V_i,\ T\subset V_j}|e_G(S)-d_{ij}(T)|S||T||,$$ 
现在的指标更加全局（$e_{\mathcal{P}}$ 的求和取遍所有 $V_i$）. 于是局部的非正则性也可能在整体上被抵消，因此是更“弱”的量.
</p>
<p>
现在我们来叙述并证明图的弱正则引理.
</p>
<p class="thm">
<b>引理3</b> (弱正则引理)<b>.</b> 对于任意 $\varepsilon > 0$ 和任意的图 $G=(V, E)$, 存在划分 $\mathcal{P}$, s.t. 将 $V$ 划分为 $k \leq 2^{2/\varepsilon^{2}}$ 个子集 $V_{1}, ..., V_{k}$，并且对任意 $S, T \subseteq V$ 有 
$$\left| e_{G}(S, T) - e_{\mathcal{P}}(S, T) \right| \leq\varepsilon|V|^{2} .$$
此时我们称 $\mathcal{P}$ 是 $G$ 的一个 $\varepsilon$-弱正则划分.
</p>
<p>
<b>注.</b> 此处不要求 $\mathcal{P}$ 是等划分. 可以用弱正则引理推出等划分的版本，代价是将 $k$ 的上界增大为 $2^{c/\varepsilon^{2}}$, 其中 $c$ 是更大的绝对常数）. 但这也远优于Szemeredi正则定理的划分数量（长度 $\varepsilon^{-2}$ 的指数塔，by Gowers）.
</p>
<p>
<i>证明.</i> 从引理1出发，我们可通过阶梯函数 $W_{G}$ 表示 $n$ 个顶点的图 $G$: 考虑 $G$ 的邻接矩阵 $A = (a_{ij})$, 将每个元素 $a_{ij}$ 替换为一个大小为 $\frac{1}{n} \times \frac{1}{n}$ 的正方形，并令 $W_{G}$ 在该正方形上恒等于 $a_{ij}$. 这自然给出了 $[0,1]$ 和 $[0,1]^2$ 的（对称）划分. 令 $\mathcal{A}$ 为这些划分得到的区间生成的子集代数, 这自然地诱导了 $[0,1]$ 上的一个测度 $\mu$.令 $K_{n}$ 为全体乘积集 $S \times S$ 的示性函数集，其中 $S$ 取遍 $\mathcal{A}$. 考虑Hilbert空间 $H=L_{d\mu}^2([0,1]^2)$, 类似于引理3.1的证明即可得到 $[0,1]$ 的弱Szemerédi划分 $\mathcal{P} = \{S_{1}, ..., S_{m}\}\subseteq \mathcal{A}$, s.t. 对任意 $S, T \in A$ 都有
$$\left| \int_{S \times T} \left( W_{G}(x, y) - W_{\mathcal{P}}(x, y) \right) dx dy \right| \leq 2\varepsilon .$$
现在只需注意到 $\mathcal{P}$ 自然地对应了 $V$ 的一个划分，并且
$$\int_{S\times T} W_G = \frac{e_G(S,T)}{|V|^2},$$
$$\int_{S\times T} W_{\mathcal{P}} = \frac{e_{\mathcal{P}}(S,T)}{|V|^2}.$$
弱正则引理得证. $\quad$$\square$
</p>

</div>

<!-- js脚本 -->
<script src="../../js/blog/post.js"></script>

</body>
</html>
