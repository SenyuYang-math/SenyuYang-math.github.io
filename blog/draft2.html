<html>
<head>  
<title>Bourgain的魔法：有限度量空间的Euclidean嵌入</title>
</head>

<body id="body">
<!--正文区块-->
<div id="container" class="container">
<p>
  <i>按：Jean Bourgain(1954-2018)绝对属于当代最富创造力的一批数学家，在诸多领域留下不胜数的成果和洞见. 也许每个分析学工作者都会在生命的某个阶段接触Bourgain的工作或思想. 这是一个(不定期)连载系列，记录Bourgain的数学魔法.</i>
</p>
<p>
  因为实在很忙所以几个长篇系列还在赶工中咕咕咕...所以先发一篇写好的短文水一水吧（笑）. 本系列写过很多调和分析和PDE方面的内容，这次我们调转视角讲讲Bourgain的早期工作，来自几何泛函分析(geometric functional analysis). 有一个来自泛函分析和计算机科学的经典的问题：一般的度量空间和Hilbert空间 $\ell^2$ (或者 $k$ 维Euclidean空间 $\mathbf{E}^k$) 相差多远？J. Bourgain在文章
</p>
<p>
  J. Bourgain, <i>On Lipschitz embedding of finite metric spaces into Hilbert space</i> 
</p>
<p>
  对有限度量空间的情形通过<b>随机化</b>和<b>尺度分解-平均</b>等技术漂亮地解决了这一问题，下面就详细展示其中的魔法. 
</p>
<h2>预备，叙述</h2>
<p class="thm">
  <b>定义.</b> 设 $(X, d_X)$ , $(Y, d_Y)$ 是（有限）度量空间，$f: X\to Y$ 为单射，则定义 $X, Y$之间的 $f$<b>-distorsion</b> $\mathrm{d}_f(X,Y) := \Vert f\Vert_{Lip} \ \Vert f^{-1}|_{f(X)}\Vert_{Lip}$ , 
  其中
  $$\Vert f\Vert_{Lip} := \sup_{x,x'\in X} \frac{d_Y(f(x), f(x'))}{d_X(x, x')} \ .$$
  进一步可以定义 $X, Y$ 之间的<b>distorsion</b> $\mathrm{d}(X,Y) := \inf_{f} \ d_f(X, Y)$ . 
</p>
<p>
  <b>注.</b> 不难得知 $\mathrm{d}_f(X,Y)\geq 1$, 等号成立 iff $f$ 是等距同构，所以distorsion $\mathrm{d}_f$ 和 $\mathrm{d}$ 就是刻画两个度量空间相差程度的理想指标.
</p>
<p class="thm">
  <b>定理</b> (Bourgain)<b>.</b> 存在常数 $C>0$ , 对任意一个 $n$-point 度量空间 $(X,d)$ 都存在一个嵌入映射 $f: X\to E=(\mathbf{E}^{O(log{n}^2)}, \Vert \cdot \Vert)$ s.t. 
  $$ \Vert f(x)-f(y)\Vert \leq d(x,y) \leq C \log{n} \Vert f(x)-f(y)\Vert \ .$$
  i.e. $\mathrm{d}(X, E)$ , $\operatorname{dim} E$ 分别有上界 $O(\log{n})$ , $O(\log{n}^2)$ . 
</p>
<p>
  这里可以看到Bourgain的结果<i>同时</i>将distorsion和dimension控制在相较于 $|X|$ 非常小的尺度，这对于理论和应用都非常重要. 比如[1]给出一个例子：给定一个有限连通无向图 $G$ , 顶点数 $|V(G)|=n$ . 可以赋予 $V(G)$ 一个度量 $d$ 为连接两点最短路径的长度，这里设每条边的长度为 $1$ . 读者可以自己证明当 $G$ 是一个square-graph（即 $4$ 个顶点首尾相连）时，$V(G)$ 不可能等距嵌入 $\ell^2$ 中（自然不可能嵌入 $\mathbf{E}^k$）. 这种非Euclidean例子在理论计算机科学和数据分析中经常出现，将这些离散数据小误差地嵌入低维度的Euclidean空间将方便我们采用高效、直观的算法进行处理. 
</p>
<p>
  <b>注.</b> 下面的命题说明Bourgain的结果是几乎sharp的，从理论上否定了更小distorsion的方案.  
</p>
<p class="thm">
  <b>命题.</b> (Bourgain)<b>.</b> 存在常数 $c>0$ s.t.  
  $$\mathrm{d}(V(G), \ell^2) \geq c \frac{\log{n}}{\log \log n} \ .$$
</p>
<p>
  事实上Linial-London-Rabinovich和Khot-Naor进一步把定理2的结果加强到sharp. 
</p>
<h2>定理的证明</h2>
<p>
  下面的证明来自<a href="https://web.math.princeton.edu/~naor/homepage%20files/embeddings_extensions.pdf" target="_blank">[Noar]</a>(p. 13-14) 对Bourgain原始证明的简化. 同时我们把dimension降低到 $(\log_2 {n})^2$
</p>
<p>
  &emsp;Step 1. 我们先在 $\mathbf{E}^{2^n}$ 上工作，用每个子集 $A\in \mathscr{P}(X)$ ($X$的幂集) 标记它的基底. 现在将 $\mathscr{P}(X)$ 看作一个（离散）概率空间: 选定一个整数 $1\leq j \leq \log_2{n} + 1$ , 我们在 $X$ 随机选取点组成一个随机集 $A_p$ ，每个点独立地有 $2^{-j}$ 的概率被选中, 这自然地诱导了 
  $$p_j : p_j(A)=\mathbb{P}(A_p=A)= \frac{1}{2^{j|A|}}\left(1-\frac{1}{2^j} \right)^{n-|A|}$$ 
  这里采用二进概率是为了和后续讨论 $A$ 的尺度相对应. 构造单射 $f_j$ : $f_j(x)$ 在 $A$-基底的（加权）坐标为 $\sqrt{p_j(A)} \ d(x,A)$ . 
  后面我们看到，可以适当选择 $O(\log{n})$ 个 $A$ 从而将 $\mathbf{E}^{2^n}$ 缩小为 $E$ . 那么
  $$\begin{align*}
  \Vert f_j(x)-f_j(y)\Vert^2 = &\sum_{A} p_j(A) \left(d(x,A)-d(y,A)\right)^2 \\ 
  \leq & \sum_{A} p_j(A) d(x,y)^2 \\
  \leq & d(x,y)^2 \ ,
  \end{align*}$$
  定理1的第一个不等号得证. 注意这一步与 $j$ 的选取无关. 可以看到 $\Vert f_j(x)-f_j(y)\Vert^2$ 等于 <i>期望</i> $\mathbb{E}_j |d(x,A)-d(y,A)|^2$ .
</p>
<p>
  &emsp;Step 2. 定理1的第二个不等号需要更多讨论. 直观上我们希望 $A$ 能良好地分离 $x, y$ 同时 $p_j(A)$ 足够大，从而控制 $\mathbb{E}_j |d(x,A)-d(y,A)|^2$ 的下界，为此我们加入一些几何上的考虑. 对于Step 1中的 $j$ 和给定的 $x,y\in X$ , 定义
  $$r_j := \inf \ \{r>0: |B(x,r)|, |B(y,r)| \geq 2^{j}\}\ ,$$
  其中 $B(x,r) := \{x'\in X : d(x,x')\leq r\}$ . 这里我们将集合的大小视为 <i>尺度</i> ，因为Step 1定义的 $p_j$ 只与 $A$ 的大小有关. 由 $r_j$ 的定义可知（不妨设）开球$B^o(x,r_j)$ 只包含 $\lt 2^j$ 个点. 一个观察是如果 $|A_0|=2^j$ , $|A_1|=2^{j-1}$ , 则分离的概率和相交的概率
  $$S_j:=\mathbb{P}(A\cap A_0=\emptyset) = (1-\frac{1}{2^j})^{2^j}\geq S_1 = \frac{1}{4} \ , $$
  $$I_j:=\mathbb{P}(A\cap A_1\neq \emptyset) = 1-(1-\frac{1}{2^j})^{2^{j-1}} \geq 1-e^{-1/2}\ .$$
  如果 $A_0\cap A_1 = \emptyset$ , 上述两个事件相互独立. 所以对 $r_j$ 做一个修正 $\tilde{r}_j := \min{(r_j, d(x,y)/3)}$ , 于是 $B^o(x,\tilde{r}_j) \cap B(y,\tilde{r}_{j-1})=\emptyset$ , 
  $$|d(x,A)-d(y,A)|\geq \tilde{r}_j-\tilde{r}_{j-1} \ , \ \text{if } A\cap B^o(x,\tilde{r}_j)=\emptyset\ , \ A\cap B(y,\tilde{r}_{j-1} \neq \emptyset \ , $$
  $$\begin{align*}
  \mathbb{P}(A\cap B^o(x,\tilde{r}_j)=\emptyset\ , \ A\cap B(y,\tilde{r}_{j-1} \neq \emptyset) \geq S_j\ I_j \geq \frac{1}{C} \ .
  \end{align*}$$
  因此如果考虑事件
  $$\Omega_{j} := \{A\subset X : d(x,A)-d(y,A)|\geq \tilde{r}_j-\tilde{r}_{j-1}\} \ ,$$
  那么有
  $$\mathbb{E}_j |d(x,A)-d(y,A)|^2 \geq \mathbb{P}(\Omega_j) (\tilde{r}_j-\tilde{r}_{j-1})^2 \geq (\tilde{r}_j-\tilde{r}_{j-1})^2/C \ .$$
  这里的关键在于 $C>0$ 与 $j$ 无关，这来自于一开始的观察中 $A_1$ 与 $A_0$ 尺度相近 $\approx 2^j$ ！
</p>
<p>
  &emsp;Step 3. 现在还有两个问题：一是 $\tilde{r}_j-\tilde{r}_{j-1}$ 无法控制 $d(x,y)$（控制distortion） , 二是 $A$ 的数量还未限制（控制dimension）. 对于前者，观察到在大尺度下（$j$ 充分大）$\tilde{r_j} \approx d(x,y)/3$ , 而 $\tilde{r_0}=0$ , 所以一个巧妙的想法是将各个尺度的概率取平均：定义新的概率测度
  $$p: p(A)=\frac{1}{1+\log{n}}\sum_{j=1}^{\log{n}+1} p_j(A) \ ,$$
  并构造真正的单射 $f$ s.t. f(x) 在 $A$-基底的坐标为 $\sqrt{p(A)} \ d(x,A)$ . 平均化不会改变Step 1的结果；而
  $$\begin{align*}
  \Vert f(x)-f(y)\Vert^2 = &\frac{1}{1+\log{n}} \sum_{j=1}^{\log{n}+1} \mathbb{E}_j \left(d(x,A)-d(y,A)\right)^2 \\ 
  \gtrsim & \frac{1}{1+\log{n}} \sum_{j=1}^{\log{n}+1} (\tilde{r}_j-\tilde{r}_{j-1})^2 \\
  \gtrsim & \frac{1}{(1+\log{n})^2} \left(\sum_{j=1}^{\log{n}+1} \tilde{r}_j-\tilde{r}_{j-1} \right)^2 \\
  \gtrsim & \frac{1}{(1+\log{n})^2} d(x,y)^2\ ,  
  \end{align*}$$
  定理1的第二个不等号得证，我们得到了 $X\to \mathbf{E}^{2^n}$ 的 $O(\log{n})$-distorsion 嵌入. 
</p>
<p>
  &emsp;Step 4. 最后一步我们来解决Step 3的第二个问题. 对于每个尺度 $j$ , 
</p>
</div>

<!-- js脚本 -->
<script src="../js/blog.js"></script>

</body>
</html>
